# Release Notes - 2026-02-12

Branch: `feat/pipeline-images-qa-fix`

Included commits:
- `bc51aec` `feat: add image fallback and QA fix flow`
- `c23f04b` `fix: stabilize qa-fix dedupe and pipeline packaging`

## Highlights
- Image strategy improvements: infographic renderer, `imagePlan`-based slotting, and a paid-image fallback stub (`PAID_IMAGE_PROVIDER=placeholder`) for when free image search fails.
- QA flow improvements: on `article_qa` failure, run `article_qa_fix` once and re-verify; global `generateImagesOnlyOnQaPass` honored.
- Pipeline reliability: Cloud Tasks queues created (`light-queue`, `heavy-queue`), dedupe/idempotency collisions fixed in QA-fix enqueue flow, and safe handling for Cloud Tasks `ALREADY_EXISTS`.
- Storage stability: `CONTENT_BUCKET` override support and runtime bucket set to `blog-native-260212-assets`.
- Concurrency fix: `image_generate` no longer overwrites existing `top` slot content during concurrent writes.
- LLM usage guard scaffolding: introduced `llmUsage` counters and cap checks wired for `title/body/qaFix`.
- Web lint fixes: removed `Date.now` during render in `metrics` and fixed sync `setState` in an effect in `auth-provider`.

## Verification Summary
- Root: `npm run lint` success; `npm run build` success; `npm test` fails (no script defined).
- `functions/`: tests, lint, build all successful.
- `apps/web/`: lint (after fixes) and build successful.
- Pipeline run (fresh `runDate/keywordId`): `image_generate` success, `article_package` success, article `status=packaged`, image slots present: `top`, `h2_1`, `h2_2`, `h2_3`, `h2_4`.

## Follow-ups
- Replace placeholder paid image provider with a real provider integration.
- Add auto-correction for `missing_hashtags_12` in QA Fix.
- Wire `llmUsage` counters into actual LLM call paths (currently scaffolding/flags only).
- Resolve GitHub auth and push `feat/pipeline-images-qa-fix`.
- Review `firebase-functions` upgrade to address deploy warnings.
- Review task retry policy (notably QA-fix delay) and document operating guidelines.
- Document bucket strategy (default bucket vs `CONTENT_BUCKET` override).

