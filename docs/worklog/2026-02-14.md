# Worklog - 2026-02-14

## 오늘 완료된 작업 (운영 최적화 + 성장 자동화 단계 진입 준비)

### Cost control 운영 반영/검증
- PR #15 merge 기준으로 `main` 동기화 후 로컬 검증 완료
  - `functions` build/test OK
  - Firestore emulator `e2e:check:timeout` OK (`firebase emulators:exec --only firestore ...`)
  - `apps/web` build OK
- Production deploy 수행
  - `firebase deploy --project blog --only functions` OK
  - `firebase deploy --project blog --only firestore:indexes` OK
- 이슈: Firebase Hosting은 현재 repo 설정상 불가
  - `firebase.json`에 `hosting` 섹션이 없어 `firebase deploy --only hosting` 실패

### Web deploy 경로 확정(런북/워크플로)
- 결론: repo 내에 web 배포 경로가 없어서(Hosting 제외) 운영에서 `/ops` 반영이 막혔던 상태
- 권장 기본안(Vercel)으로 런북/워크플로 추가
  - Runbook: `docs/runbooks/web-deploy.md`
  - Workflow: `.github/workflows/web-deploy-vercel.yml`
  - 필요한 GitHub Secrets: `VERCEL_TOKEN`, `VERCEL_ORG_ID`, `VERCEL_PROJECT_ID`

### runDate(KST) 표준화
- 표준 문서: `docs/runbooks/runDate.md`
- `/ops` 기본 날짜를 KST 기준으로 초기화 + UI에 `runDate=KST` 표기
- Functions에서도 “today KST” 계산 유틸로 표준화

### Budgets/alerts/hard-stop (PR #18 충돌 해결)
- `feat/budgets-alerts-hardstop`를 `origin/main`으로 rebase 후 충돌 해소
  - 충돌 파일: `apps/web/src/app/ops/page.tsx`
  - 기준: main 최신 `/ops` 구조(필터/표/위젯/KST runDate)를 유지하고 budgets 레이어만 추가
- 로컬 검증 후 `git push --force-with-lease`로 PR conflict 제거

## 다음 할 일 (우선순위)
1) PR #18(Squash merge)
   - PR 화면에서 conflicts 제거 확인 + checks green 확인 후 merge
2) Web deploy 실제 운영 반영
   - Vercel 프로젝트 생성/연결 + secrets/env 설정
   - main push 또는 workflow_dispatch로 배포 후 `/ops`가 운영 URL에서 보이는지 확인
3) budgets 설정 적용/검증
   - `settings/global.budgets` 입력(dailyUsdTotal/perSite/thresholds/webhook)
   - 80% 경고 배지 + 100% 하드스톱(BUDGET_EXCEEDED) 동작 확인
4) cost recompute 도구 운영 투입(필요 시)
   - dryRun으로 예상 writes 확인 후 apply 모드 실행

